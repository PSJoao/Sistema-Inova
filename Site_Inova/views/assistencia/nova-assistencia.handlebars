{{!--
  views/assistencia/nova-assistencia.handlebars
  - Versão 2: Opções de Categoria (Descrição) corrigidas para corresponder à especificação.
--}}
<link rel="stylesheet" href="/public/styles/assistencia.css">

<div class="content-card">
    <div class="page-header-actions">
        <h1 class="page-title">{{title}}</h1>
    </div>

    
    <form action="/assistencias" method="POST" id="form-nova-assistencia">

        <h5 class="form-section-title">Dados da Solicitação</h5>
        <div class="row mb-3">
            <div class="form-check">
                <input class="form-check-input" type="checkbox" value="true" id="para_vistoriar" name="para_vistoriar">
                <label class="form-check-label" for="para_vistoriar">
                    Marcar para Vistoriar
                </label>
            </div>
            <div class="col-md-5" style="padding-bottom: 20px;">
                <label for="descricao" class="form-label" style="padding-right: 5px;">Categoria <span class="text-danger">*</span> </label>
                <select id="descricao" name="descricao" class="form-control" style="max-width: 400px;" required>
                    <option value="" disabled selected>Selecione a categoria...</option>
                    <option value="PEÇA PARA CLIENTE">PEÇA PARA CLIENTE</option>
                    <option value="PEÇA PARA REPOR VOLUME">PEÇA PARA REPOR VOLUME</option>
                    <option value="PEÇA PARA ESTOQUE">PEÇA PARA ESTOQUE</option>
                    <option value="PEÇA PARA CLIENTE LOJA FISICA">PEÇA PARA CLIENTE LOJA FISICA</option>
                    <option value="PEÇA PARA MOSTRUÁRIO LOJA">PEÇA PARA MOSTRUÁRIO LOJA</option>
                </select>
            </div>
            <div class="col-md-4" style="padding-bottom: 20px;">
                <label for="solicitante_id" class="form-label">Solicitante <span class="text-danger">*</span></label>
                <div class="input-group" style="display: flex; flex-direction: row;">
                    <select id="solicitante_id" name="solicitante_id" class="form-control" style="max-width: 400px;" required>
                        <option value="">Carregando...</option>
                    </select>
                    <button class="btn btn-outline-secondary" type="button" id="btn-add-solicitante" title="Adicionar Novo Solicitante">
                        <i class="fas fa-plus"></i> Novo Solicitante
                    </button>
                </div>
            </div>
            <div class="col-md-3">
                <label for="data_solicitacao" class="form-label">Data da Solicitação <span class="text-danger">*</span></label>
                <input type="date" id="data_solicitacao" name="data_solicitacao" class="form-control" required>
            </div>
        </div>
        
        {{!-- O resto do formulário permanece o mesmo --}}
        <h5 class="form-section-title mt-4" style="padding-top: 20px;">Dados do Pedido</h5>
        <div class="row mb-3">
            <div class="col-md-4" style="padding-bottom: 20px;">
                <label for="nf_origem" class="form-label">NF Origem</label>
                <input type="text" id="nf_origem" name="nf_origem" class="form-control" placeholder="Digite para importar dados...">
            </div>
            <div class="col-md-5" style="padding-bottom: 20px;">
                <label for="nome_pedido" class="form-label" >Nome do Cliente/Pedido <span class="text-danger">*</span></label>
                <input type="text" id="nome_pedido" name="nome_pedido" class="form-control" required>
            </div>
            <div class="col-md-3" style="padding-bottom: 20px;">
                <label for="documento_cliente" class="form-label">Documento do Cliente</label>
                <input type="text" id="documento_cliente" name="documento_cliente" class="form-control">
            </div>
        </div>
        <div class="row mb-3">
            <div class="col-md-4" style="padding-bottom: 20px;">
                <label for="numero_pedido_venda" class="form-label">Número do Pedido de Venda</label>
                <input type="text" id="numero_pedido_venda" name="numero_pedido_venda" class="form-control">
            </div>
            <div class="col-md-2" style="padding-bottom: 20px;">
                <label for="coluna_estoque" class="form-label">Coluna</label>
                <input type="text" id="coluna_estoque" name="coluna_estoque" class="form-control">
            </div>
            <div class="col-md-2" style="padding-bottom: 20px;">
                <label for="linha_estoque" class="form-label">Linha</label>
                <input type="text" id="linha_estoque" name="linha_estoque" class="form-control">
            </div>
        </div>
        <div class="row mb-3" style="padding-bottom: 20px;">
            <div class="col-md-12">
                <div style="display: flex; flex-direction: row; gap: 25px;">
                    <label for="observacoes" class="form-label">Observações</label>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="true" id="marcar_como_alerta" name="marcar_como_alerta">
                        <label class="form-check-label" for="marcar_como_alerta">
                            Marcar como Alerta
                        </label>
                    </div>
                </div>
                <textarea id="observacoes" name="observacoes" class="form-control" rows="3"></textarea>
            </div>
        </div>
        <div class="row mb-3">
                <div class="col-md-4" style="padding-bottom: 20px;">
                    <label for="fabrica_id" class="form-label">Fábrica <span class="text-danger">*</span></label>
                        <div class="input-group" style="display: flex; flex-direction: row;">
                            <select id="fabrica_id" name="fabrica_id" class="form-control" style="max-width: 400px;" required>
                                <option value="">Carregando...</option>
                            </select>
                            <button class="btn btn-outline-secondary" type="button" id="btn-add-fabrica" title="Adicionar Nova Fábrica">
                                <i class="fas fa-plus"></i> Nova Fábrica
                            </button>
                        </div>
                </div>
            <div class="col-md-6" style="padding-bottom: 40px;">
                <label for="cor" class="form-label">Cor</label>
                <input type="text" id="cor" name="cor" class="form-control">
            </div>
        </div>
        <hr class="my-4">
        <div class="d-flex justify-content-between align-items-center mb-3" style="padding-top: 20px;">
            <h5 class="mb-0">Produtos e Peças Solicitadas</h5>
            <button type="button" id="btn-add-produto" class="btn btn-secondary btn-sm" style="margin-bottom: 15px;">
                <i class="fas fa-plus me-2"></i>Adicionar Produto
            </button>
        </div>
        <div id="produtos-container"></div>
        <div class="d-flex justify-content-end mt-4">
            <a href="/assistencias" class="btn btn-light me-2">Cancelar</a>
            <button type="submit" class="btn btn-primary">Salvar Assistência</button>
        </div>
    </form>
</div>

{{#section "scripts"}}
    <script src="/public/scripts/novaAssistenciaManager.js"></script>
{{/section}}
