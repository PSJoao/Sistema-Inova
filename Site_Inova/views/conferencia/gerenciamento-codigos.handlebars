{{!< main}}

{{#section "head"}}
  <link href="/public/styles/nfeHistory.css" rel="stylesheet">
  <link href="/public/styles/conferencia.css" rel="stylesheet">
  <style>
      /* Ajustes específicos para a tabela de edição inline */
      .editing-input {
          width: 100%;
          padding: 5px;
          border: 2px solid #ff6b00;
          border-radius: 4px;
          background: #2d2d2d;
          color: #fff;
      }
      .action-btn-group {
          display: flex;
          gap: 5px;
          justify-content: center;
          flex-wrap: wrap;
      }
      .hidden-row {
          opacity: 0.6;
          background-color: rgba(0, 0, 0, 0.2);
      }

      /* Responsividade da página de gerenciamento */
      .content-card {
          padding: 15px;
          overflow-x: hidden;
      }

      /* Filtros responsivos */
      .nfe-history-filters {
          display: flex;
          flex-direction: row;
          align-items: flex-end;
          gap: 1rem;
          flex-wrap: wrap;
      }

      .filter-group {
          display: flex;
          flex-direction: column;
      }

      .filter-group:first-child {
          min-width: 200px;
          max-width: 250px;
          flex-shrink: 0;
      }

      .filter-group.search-group {
          flex: 1;
          min-width: 300px;
      }

      .filter-group input[type="text"],
      .filter-group select {
          width: 100%;
          box-sizing: border-box;
      }

      .input-icon-wrapper {
          width: 100%;
          position: relative;
      }

      /* Campo de pesquisa maior */
      #search-input {
          min-width: 100%;
          font-size: 1rem;
          padding: 10px 15px;
      }

      /* Wrapper da tabela responsiva */
      .table-responsive-wrapper {
          width: 100%;
          margin-bottom: 20px;
          border: 1px solid var(--bg-tertiary);
          border-radius: var(--border-radius-lg);
          overflow: hidden;
      }

      /* Tabela responsiva */
      .table-responsive {
          width: 100%;
          overflow-x: auto;
          -webkit-overflow-scrolling: touch;
          position: relative;
      }

      #table-gerenciamento-codigos {
          min-width: 800px;
          margin: 0;
      }

      /* Scrollbar customizada para a tabela */
      .table-responsive::-webkit-scrollbar {
          height: 8px;
      }

      .table-responsive::-webkit-scrollbar-track {
          background: var(--bg-secondary);
      }

      .table-responsive::-webkit-scrollbar-thumb {
          background: var(--bg-tertiary);
          border-radius: 4px;
      }

      .table-responsive::-webkit-scrollbar-thumb:hover {
          background: var(--accent-orange);
      }

      /* Correção das cores da paginação */
      .dataTables_paginate .paginate_button {
          background-color: var(--bg-tertiary) !important;
          color: var(--text-primary) !important;
          border: 1px solid var(--bg-tertiary) !important;
      }

      .dataTables_paginate .paginate_button:hover:not(.disabled) {
          background-color: var(--accent-orange-hover) !important;
          color: #ffffff !important;
          border-color: var(--accent-orange-hover) !important;
      }

      .dataTables_paginate .paginate_button.current,
      .dataTables_paginate .paginate_button.current:hover {
          background-color: var(--accent-orange) !important;
          color: #ffffff !important;
          border-color: var(--accent-orange) !important;
          font-weight: 600;
      }

      .dataTables_paginate .paginate_button.disabled,
      .dataTables_paginate .paginate_button.disabled:hover {
          background-color: #1a1a1a !important;
          color: var(--text-muted) !important;
          border-color: #1a1a1a !important;
          opacity: 0.5;
          cursor: not-allowed;
      }

      /* Info da tabela */
      .dataTables_info {
          color: var(--text-primary) !important;
      }

      /* Wrapper do DataTables */
      .dataTables_wrapper {
          padding: 15px;
          background-color: var(--bg-secondary);
          border-radius: var(--border-radius-lg);
      }

      /* Ajustes para os controles do DataTables */
      .dataTables_length,
      .dataTables_filter {
          margin-bottom: 15px;
      }

      .dataTables_length label,
      .dataTables_filter label {
          color: var(--text-primary) !important;
      }

      .dataTables_length select,
      .dataTables_filter input[type="search"] {
          background-color: var(--bg-primary);
          color: var(--text-primary);
          border: 1px solid var(--bg-tertiary);
      }

      .dataTables_length select:focus,
      .dataTables_filter input[type="search"]:focus {
          border-color: var(--accent-orange);
          box-shadow: 0 0 0 0.2rem rgba(240, 124, 0, 0.25);
      }

      /* Mobile */
      @media (max-width: 768px) {
          .content-card {
              padding: 10px;
          }

          .page-header-actions {
              flex-direction: column;
              align-items: flex-start;
              gap: 10px;
          }

          .nfe-history-filters {
              padding: 0.75rem;
              flex-direction: column;
              align-items: stretch;
          }

          .filter-group:first-child {
              min-width: 100%;
              max-width: 100%;
          }

          .filter-group.search-group {
              min-width: 100%;
          }

          .filter-group label {
              font-size: 0.8rem;
          }

          #search-input {
              font-size: 0.9rem;
              padding: 8px 12px;
          }

          #table-gerenciamento-codigos {
              min-width: 600px;
              font-size: 0.85rem;
          }

          #table-gerenciamento-codigos th,
          #table-gerenciamento-codigos td {
              padding: 8px 6px;
              white-space: nowrap;
          }

          .action-btn-group {
              gap: 3px;
          }

          .action-btn-group .btn {
              padding: 4px 6px;
              font-size: 0.75rem;
          }

          .dataTables_paginate {
              display: flex;
              flex-wrap: wrap;
              justify-content: center;
              gap: 5px;
          }

          .dataTables_paginate .paginate_button {
              padding: 6px 10px;
              font-size: 0.75rem;
              margin: 2px;
              min-width: 32px;
          }

          .dataTables_info {
              font-size: 0.75rem;
              padding: 10px 0;
              text-align: center;
          }
      }

      /* Tablet */
      @media (min-width: 769px) and (max-width: 1024px) {
          .filter-group:first-child {
              min-width: 180px;
              max-width: 220px;
          }

          .filter-group.search-group {
              min-width: 250px;
          }

          #table-gerenciamento-codigos {
              min-width: 700px;
          }
      }

      /* Desktop - ajustes finos */
      @media (min-width: 1025px) {
          .filter-group:first-child {
              min-width: 200px;
              max-width: 250px;
          }

          .filter-group.search-group {
              min-width: 400px;
          }

          #search-input {
              font-size: 1rem;
              padding: 12px 18px;
          }
      }
  </style>
{{/section}}

<div class="content-card">
    <div class="page-header-actions">
        <h1 class="page-title">{{title}}</h1>
    </div>

    {{!-- Área de Filtros (Padrão nfeHistory) --}}
    <div class="nfe-history-filters">
        <div class="filter-group">
            <label for="filter-visibility">Visualização:</label>
            <select id="filter-visibility" class="form-control form-control-sm">
                <option value="todos">Todos</option>
                <option value="nao_escondidos" selected>Ativos</option>
                <option value="escondidos">Escondidos</option>
            </select>
        </div>
        
        <div class="filter-group search-group">
            <label for="search-input">Pesquisa Rápida:</label>
            <div class="input-icon-wrapper">
                <input type="text" id="search-input" class="form-control form-control-sm" placeholder="Nome, SKU ou Código de Fábrica...">
            </div>
        </div>
    </div>

    {{!-- Tabela de Dados --}}
    <div class="table-responsive-wrapper">
        <div class="table-responsive">
            <table id="table-gerenciamento-codigos" class="table table-striped table-hover display" style="width:100%">
                <thead>
                    <tr>
                        <th style="width: 50px; text-align: center;" title="Marcar para esconder da conferência">Ocultar</th>
                        <th>SKU</th>
                        <th>Nome</th>
                        <th>Cód. Fábrica (Etiqueta)</th>
                        <th>EAN Transformado (Padrão)</th>
                        <th style="width: 100px; text-align: center;">Ações</th>
                    </tr>
                </thead>
                <tbody>
                    {{!-- Preenchido via DataTables (AJAX) --}}
                </tbody>
            </table>
        </div>
    </div>
</div>

{{#section "scripts"}}
  {{!-- Manager Exclusivo para esta tela --}}
  <script src="/public/scripts/conferenciaGerenciamentoManager.js"></script>
{{/section}}